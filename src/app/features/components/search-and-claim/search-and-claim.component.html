<div class="min-h-screen flex flex-col">
  <div class="px-5 pt-5 pb-5 bg-[#E8F2F3]">
    <h1 class="font-semibold max-w-3xs mr-6 text-2xl">Search and Claim</h1>
    <mat-card>
      <mat-accordion>
        <mat-expansion-panel hideToggle [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title class="text-lg">
              <span class="font-semibold">Filters</span>
            </mat-panel-title>
            <mat-icon>{{ containerPanelOpened ? 'expand_less' : 'expand_more' }}</mat-icon>
          </mat-expansion-panel-header>
     
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Item Type Search -->
        <div class="text-center">
          <h3 class="font-medium text-lg mb-4">Item Type Search</h3>
          <mat-form-field appearance="outline" class="w-full">
            <mat-label>Enter item name</mat-label>
            <input
              type="text"
              matInput
              placeholder="Search items"
              [(ngModel)]="searchQuery"
              (keyup.enter)="searchItems()"
            />
            <button
              mat-icon-button
              matSuffix
              (click)="searchItems()"
              aria-label="Search"
            >
              <mat-icon>search</mat-icon>
            </button>
          </mat-form-field>
          <mat-form-field appearance="outline" class="w-full">
            <mat-label>Saved Searches</mat-label>
            <mat-select [(ngModel)]="selectedSavedSearch" (selectionChange)="applySavedSearch()">
              <mat-option *ngFor="let search of savedSearches" [value]="search">
                {{ search }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
  
        <!-- Picture Upload Section -->
        <div class="text-center">
          <h3 class="font-medium text-lg mb-4">Picture</h3>
          <div class="border border-dashed border-gray-400 rounded-lg p-4 text-center">
            <ngx-dropzone (change)="onSelect($event)">
              <ngx-dropzone-label>
                Drag and drop image here or click to upload
              </ngx-dropzone-label>
              <ngx-dropzone-preview
                ngProjectAs="ngx-dropzone-preview"
                [removable]="true"
                *ngFor="let f of files"
                [file]="f.file"
                (removed)="onRemove(f)"
              >
                <ngx-dropzone-label class="block text-sm">{{ f.file.name }}</ngx-dropzone-label>
              </ngx-dropzone-preview>
            </ngx-dropzone>
          </div>
        </div>
  
        <!-- Category Section -->
        <div class="text-center">
          <h3 class="font-medium text-lg mb-4">Category</h3>
          <div class="h-64 overflow-y-auto border rounded-lg p-4">
            <div class="grid grid-cols-1 gap-4">
              <mat-card
                *ngFor="let item of categories"
                class="shadow-md hover:bg-gray-100 cursor-pointer p-4"
                (click)="selectCategory(item.name)"
              >
                <mat-card-header class="flex justify-center items-center h-12">
                  <mat-icon [ngStyle]="{ color: '#388d97' }" class="text-xl">
                    {{ getCategoryIcon(item.name) }}
                  </mat-icon>
                </mat-card-header>
                <mat-card-title
                  class="text-center text-sm font-medium truncate"
                  [title]="item.name"
                >
                  {{ item.name }}
                </mat-card-title>
              </mat-card>
            </div>
          </div>
        </div>
      </div>
  
      <!-- Action Buttons -->
      <div class="flex justify-end gap-4 mt-6">
        <button mat-raised-button color="primary" (click)="searchItems()">
          Search
        </button>
        <button mat-flat-button color="primary" (click)="saveSearch()">
          Save Search
        </button>
        <button mat-raised-button color="primary" (click)="onImportToExcel()">
          <mat-icon>upload</mat-icon> Upload Image
        </button>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
    </mat-card>
  </div>
  
  
  <div *ngIf="searchResults?.length > 0" class="flex-grow mt-14 mx-3 scrollbar-hide overflow-y-auto">
    <app-data-table
      (ClaimItem)="claimItem($event)"
      (previewImage)="previewImage($event)"
      [showUnClaim]="true"
      [tableColumns]="displaycoloums"
      [isPageable]="true"
      [tableData]="searchResults"
      (sort)="handleSort($event)"
      [paginationSizes]="[5, 10, 15, 20]"
      [defaultPageSize]="15"
    ></app-data-table>
  </div>
  
  <div *ngIf="!searchResults?.length && categerorydata?.length > 0" class="flex-grow mt-5">
    <app-data-table
      [tableData]="categerorydata"
      [tableColumns]="displaycoloums"
      [isPageable]="true"
      [defaultPageSize]="15"
      (ClaimItem)="claimItem($event)"
      (previewImage)="previewImage($event)"
      (sort)="handleSort($event)"
    ></app-data-table>
  </div>
  
</div>
